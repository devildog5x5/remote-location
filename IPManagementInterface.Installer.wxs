<?xml version="1.0" encoding="UTF-8"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">
  <Product Id="*" 
           Name="IP Management Interface" 
           Language="1033" 
           Version="1.0.0" 
           Manufacturer="IP Management Interface" 
           UpgradeCode="A1B2C3D4-E5F6-4A5B-8C9D-0E1F2A3B4C5D">
    
    <Package InstallerVersion="200" 
             Compressed="yes" 
             InstallScope="perMachine"
             Description="IP Management Interface - IoT Device Management Dashboard"
             Comments="Self-contained application for managing IP devices"
             Manufacturer="IP Management Interface"/>
    
    <MajorUpgrade DowngradeErrorMessage="A newer version of [ProductName] is already installed." />
    
    <MediaTemplate EmbedCab="yes" />
    
    <!-- Application Icon -->
    <Icon Id="AppIcon" SourceFile="IPManagementInterface\Resources\TestWrrior.ico"/>
    <Property Id="ARPPRODUCTICON" Value="AppIcon" />
    
    <!-- Install Directory -->
    <Directory Id="TARGETDIR" Name="SourceDir">
      <Directory Id="ProgramFilesFolder">
        <Directory Id="INSTALLFOLDER" Name="IPManagementInterface">
          <Component Id="ApplicationFiles" Guid="B1C2D3E4-F5A6-4B7C-8D9E-0F1A2B3C4D5E">
            <File Id="ApplicationExe" 
                  Source="IPManagementInterface\bin\Release\net8.0-windows\win-x64\publish\IPManagementInterface.exe" 
                  KeyPath="yes">
              <Shortcut Id="ApplicationStartMenuShortcut"
                        Directory="ApplicationProgramsFolder"
                        Name="IP Management Interface"
                        WorkingDirectory="INSTALLFOLDER"
                        Icon="AppIcon"
                        IconIndex="0"
                        Advertise="yes"/>
              <Shortcut Id="ApplicationDesktopShortcut"
                        Directory="DesktopFolder"
                        Name="IP Management Interface"
                        WorkingDirectory="INSTALLFOLDER"
                        Icon="AppIcon"
                        IconIndex="0"
                        Advertise="yes"/>
            </File>
          </Component>
        </Directory>
      </Directory>
      
      <!-- Start Menu Folder -->
      <Directory Id="ProgramMenuFolder">
        <Directory Id="ApplicationProgramsFolder" Name="IP Management Interface"/>
      </Directory>
      
      <!-- Desktop Folder -->
      <Directory Id="DesktopFolder" Name="Desktop"/>
    </Directory>
    
    <!-- Features -->
    <Feature Id="MainFeature" Title="IP Management Interface" Level="1">
      <ComponentRef Id="ApplicationFiles" />
      <ComponentRef Id="RegistryEntries" />
    </Feature>
    
    <!-- UI -->
    <UIRef Id="WixUI_InstallDir" />
    <WixVariable Id="WixUILicenseRtf" Value="" />
    <WixVariable Id="WixUIBannerBmp" Value="" />
    <WixVariable Id="WixUIDialogBmp" Value="" />
    
    <!-- Set INSTALLFOLDER property -->
    <Property Id="WIXUI_INSTALLDIR" Value="INSTALLFOLDER" />
    
  </Product>
</Wix>
